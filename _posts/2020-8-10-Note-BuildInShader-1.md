---
layout:     post
title:      "U3D内建着色器源码剖析学习笔记（一）"
subtitle:   ""
date:       2020-8-10
author:     "Burt"
header-style: text 
tags:
    - Note
	- Shader
---









## 前言

观摩《U3D内建着色器源码剖析》第一章的学习笔记





## 渲染管线

### 一、顶点处理阶段（vertex processing）

对存储在顶点缓冲区（vertex buffer）中的各项点执行各种操作，如坐标系变换等。

#### 1.顶点的组织方式

- 索引方式：顶点缓冲区和索引缓冲区，不直观，但是能好好利用顶点

- 非索引方式：只有顶点缓冲区，比较直观，但是会造成顶点冗杂


#### 2.顶点的转换

  - 转换过程

       - 模型空间
       - 世界空间
       - 观察空间
       - 裁剪空间

  - 变换

       - 仿射变换：用于世界变换和观察变换。其中**缩放变换**和**旋转变换**统称**线性变换**
            - 缩放变换
            - 旋转变换
            - 平移变换
       - 投影变换： 用于投影变换

  	 

### 二、光栅化阶段（rasterization）

对由顶点构成并变换到裁剪空间的多边形进行扫描插值，将这些多边形转换成一系列的片元组合。片元是指一组数据值，这些数据最终用于对颜色缓冲区（color buffer）中的像素颜色值，透明值，以及深度缓冲区中的深度值进行更新。

#### 1.裁剪操作

对图元进行剪切操作：

- 完全在裁剪空间内，传递给下一步骤
- 完全在裁剪空间外，舍弃之
- 与裁剪空间相交，则进行裁剪操作

#### 2.透视除法

通过使用投影矩阵，把视截体变换为表示裁剪空间的立方体视见体

#### 3.背面剔除

把摄像机不可见的内容排除掉，使用点积判断

#### 4.视口变换

视口（viewport）可以视为当前场景所投影的矩阵区域。视口定义于当前屏幕空间中，并且不一定非得为全部屏幕，可以为当前进程窗口得部分区域。经过视口变换之后，组成图元的顶点即完全变换到二维屏幕上

#### 5.扫描变换

把顶点插值成片元

### 三、片元处理阶段（fragment processing）

片元处理阶段对各个片元进行操作，确定每个片元的最终颜色值和透明值。

### 四、输出合并阶段（output merging）

输出合并阶段则是对片元与颜色缓冲区中的像素进行比较或者合并操作，然后更新像素的颜色值和透明值。

- 深度值
- Alpha值